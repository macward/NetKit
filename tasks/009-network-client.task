# Task: NetworkClient Implementation

## Objective
Create the main NetworkClient class that orchestrates all networking operations.

## Context
- Related files:
  - `Sources/NetKit/Core/NetworkClient.swift`
- Dependencies: ALL previous tasks (001-008)
- Branch: `feature/network-client`

## Steps
1. [x] Create `NetworkClient.swift` as `final class`
2. [x] Implement initializer:
   - `environment: Environment`
   - `interceptors: [Interceptor] = []`
   - `retryPolicy: RetryPolicy? = nil`
   - `cache: ResponseCache? = nil`
3. [x] Implement `request<E: Endpoint>(_ endpoint: E) async throws -> E.Response`
4. [x] Build URLRequest from endpoint + environment
5. [x] Run request interceptors (in order)
6. [x] Execute URLSession request
7. [x] Run response interceptors (in reverse order)
8. [x] Handle HTTP status codes → NetworkError mapping
9. [x] Decode response (skip for EmptyResponse)
10. [x] Implement retry logic using RetryPolicy
11. [x] Implement cache check/store logic
12. [x] Add method returning RequestBuilder for fluent API

## Acceptance Criteria
- [x] Conforms to NetworkClientProtocol
- [x] Supports simple `request()` call
- [x] Supports fluent `request().timeout().header().send()` pattern
- [x] Runs interceptors in correct order
- [x] Handles EmptyResponse without decoding
- [x] Maps HTTP status codes to NetworkError
- [x] Retries according to policy
- [x] Caches responses when cache is configured
- [x] Thread-safe (Sendable)

## Notes
- Use URLSession.shared or allow custom session injection
- EmptyResponse detection: check if Response == EmptyResponse.self
- Status code mapping: 401→unauthorized, 403→forbidden, 404→notFound, 5xx→serverError
- Consider making client an actor for thread safety
