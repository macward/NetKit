# Task: Enhanced NetworkError with Context

Status: done

## Objective
Mejorar NetworkError para incluir contexto completo del request/response, facilitando debugging y observabilidad.

## Context
- Related files: Sources/NetKit/Models/NetworkError.swift, Sources/NetKit/Core/NetworkClient.swift
- Dependencies: none

## Steps
1. [x] Crear RequestSnapshot struct (URL, method, headers sanitizados, body size)
2. [x] Crear ResponseSnapshot struct (statusCode, headers, body preview)
3. [x] Refactorizar NetworkError como struct con ErrorKind enum
4. [x] Agregar campos: timestamp, retryAttempt, underlyingError
5. [x] Crear ErrorKind cases específicos (timeout, rateLimited, gatewayTimeout, etc.)
6. [x] Implementar sanitización de headers sensibles en snapshots
7. [x] Actualizar todos los throw sites en NetworkClient
8. [x] Mantener Equatable de forma robusta (no basado en localizedDescription)

## Acceptance Criteria
- [x] NetworkError incluye request context (URL, method)
- [x] NetworkError incluye response context cuando disponible
- [x] Headers sensibles (Authorization, API keys) están sanitizados
- [x] ErrorKind distingue entre diferentes tipos de server errors
- [x] Tests verifican contexto en errores

## Notes
- No incluir body completo en snapshot (solo tamaño o preview truncado)
- Considerar conformance a LocalizedError para mensajes útiles

## Completion Notes
- Completed: 2026-01-21
- Added LocalizedError and CustomDebugStringConvertible conformance
- Added helper properties on ErrorKind: isServerError, isClientError, isRetryable, statusCode
- Body preview is truncated at UTF-8 boundaries (max 512 bytes)
- All 109 tests pass
